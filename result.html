<!doctype html>
<html>

<head>
  <style>
    * {
      box-sizing: border-box;
    }

    pre {
      width: 100%;
      overflow: auto;
    }

    textarea {
      width: 100%;
      height: 200px;
      display: block;
      resize: none;
      padding: 9px;
    }

    .cont {
      margin: 0 20px 20px;;
      background-color: rgb(244, 245, 247);
      padding: 1px 20px 20px;
      border-radius: 4px;
      box-shadow: rgb(235 236 240) 0px 0px 0px 1.2px;
    }
  </style>
</head>

<body>
  <div>
    <div class="cont">
      <h3>Access token (short-lived):</h3>
      <textarea readonly>{{ .Token.AccessToken }}</textarea>
    </div>
    <div class="cont">
      <h3>Refresh token:</h3>
      <textarea readonly>{{ .Token.RefreshToken }}</textarea>
    </div>
    <div class="cont">
      <h3>Obtain new access token:</h3>
      <pre><code>
POST https://login.microsoftonline.com/{{.Config.OrgID}}/oauth2/v2.0/token
Content-Type: application/x-www-form-urlencoded

client_id={{ .Config.ClientID }}&redirect_uri={{ .Config.RedirectURI }}&client_secret={{ .Config.ClientSecret }}&refresh_token={{.Token.RefreshToken}}&grant_type=refresh_token
      </code>
    </pre>
    </div>
  </div>
  <script>
    history.replaceState(null, '', '/')
  </script>
</body>

</html>